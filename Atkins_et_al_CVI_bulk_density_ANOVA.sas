data cvi_bulk;

/* Code written 2012 - 2014 by Jeff Atkins (jeffatkins@virginia.edu or via Twitter @atkinsjeff or on GitHub https://github.com/atkinsjeff)

This code analyzes data from the Weimer Run watershed within the Little Canaan WMA near Davis, West Virginia

Analysis of data are presented in:

http://www.biogeosciences-discuss.net/11/17631/2014/bgd-11-17631-2014.pdf

Data were collected between in 2011, 2012, and 2013

Clarification of column values. For complete methods and further clarification of variables refer to paper above:
ELEV - elevation class (high, mid, low)
VEG - vegetation class (canopy, open, shrub)
REP - replicate plot within in study design (1, 2, 3) *note this is considered a factor variable
ID - identification variable where low open replicate 1 would be LO1, etc.
YEAR - calendar year of measurements (2010-2012)
DEPTH - soil profile depth in cm * 5 is 0-5 cm, 12 0-12 cm, etc.
BULKs - Soil bulk density (g cm^-3) see**
BULKt - Total bulk density (g cm^-3)
SOM - soil organic matter by loss on ignition (%)
part - particle density (g cm^-3)
pore - soil porosity (m^3 m^-3)


**Soil bulk density (?s) is defined as the bulk density of the soil fraction, where the soil
fraction consists of soil that has been sieved to less than 2 mm and all gravel and root material have been removed. Total bulk density (?t
10 ) is defined as the absolute density of the sampled soil, including soil, roots, and gravel and is simply the sample
dry mass over the sample volume.
*/

/*BEGIN SAS SCRIPT*/

input ELEV $ VEG $ REP $ ID $ YEAR $ DEPTH $ BULKs BULKt SOM part pore;


datalines;
LOW	OPEN	1	LO1	2012	12	0.67400701	0.728436204	13.1716542	2.268327659	0.67886641
LOW	SHRUB	1	LS1	2012	12	0.430060426	0.466719254	10.3466326	2.06122603	0.773572016
LOW	CLOSED	1	LC1	2012	12	0.491398195	0.521989223	60.8786611	2.178053471	0.760341411
LOW	OPEN	2	LO2	2012	12	0.97050617	1.011575141	38.425222	2.488744821	0.593540032
LOW	SHRUB	2	LS2	2012	12	0.592773436	0.601056475	24.3483817	2.311079174	0.739923893
LOW	CLOSED	2	LC2	2012	12	0.657941652	0.72606977	64.3410853	2.102549548	0.654671743
LOW	OPEN	3	LO3	2012	12	0.081979133	0.086928777	.	.	.
LOW	SHRUB	3	LS3	2012	12	0.079820612	0.079820612	19.9261993	1.635997535	0.951209821
LOW	CLOSED	3	LC3	2012	12	0.16949958	0.172421739	80.1405975	1.624727436	0.893876514
MID	OPEN	1	MO1	2012	12	0.861665544	0.861665544	11.6345062	2.425335687	0.644723183
MID	SHRUB	1	MS1	2012	12	0.51307556	0.506434573	20.7612457	2.202533664	0.770067272
MID	CLOSED	1	MC1	2012	12	0.792824601	0.786028291	17.7094972	2.384742391	0.670392788
MID	OPEN	2	MO2	2012	12	0.643998241	0.634913319	26.3345196	2.194053873	0.710620907
MID	SHRUB	2	MS2	2012	12	0.904952671	0.904952671	16.3844894	2.347305825	0.614471765
MID	CLOSED	2	MC2	2012	12	0.480895772	0.486049562	42.5696594	2.120337276	0.770767808
MID	OPEN	3	MO3	2012	12	0.588611798	0.58754919	14.2671292	2.277413499	0.742010316
MID	SHRUB	3	MS3	2012	12	0.18536179	0.18536179	28.4589	2.03310242	0.90882811
MID	CLOSED	3	MC3	2012	12	0.991743738	0.994221293	10.4587156	2.354215086	0.577684597
HIGH	OPEN	1	HO1	2012	12	0.636190983	0.63872443	16.0633153	2.264588017	0.717951157
HIGH	SHRUB	1	HS1	2012	12	0.124104029	0.132351898	27.9785801	1.458796822	0.909273247
HIGH	CLOSED	1	HC1	2012	12	0.559613578	0.563104903	13.5951662	1.767737173	0.681454397
HIGH	OPEN	2	HO2	2012	12	0.649579365	0.638795334	63.0136986	2.197813995	0.709349683
HIGH	SHRUB	2	HS2	2012	12	0.159981621	0.168566313	63.2543521	2.16507963	0.922143135
HIGH	CLOSED	2	HC2	2012	12	0.472078619	0.485269614	61.2244898	1.413257369	0.656630403
HIGH	OPEN	3	HO3	2012	12	0.997261024	1.056546247	19.2287375	2.386676506	0.55731485
HIGH	SHRUB	3	HS3	2012	12	0.231808881	0.243007055	40.8269905	2.146465821	0.886787363
HIGH	CLOSED	3	HC3	2012	12	0.542590178	0.543287127	.	2.30918532	0.764727793
LOW	OPEN	1	LO1	2011	20	0.854080956	0.98427994	8.991907283	.	.
LOW	SHRUB	1	LS1	2011	20	0.84808623	0.957094235	12.16121612	.	.
LOW	CLOSED	1	LC1	2011	20	0.584834869	0.822080408	15.3	.	.
LOW	OPEN	2	LO2	2011	20	1.399598595	1.303467347	5.355180338	.	.
LOW	SHRUB	2	LS2	2011	20	0.355926654	0.364879813	23.25837081	.	.
LOW	CLOSED	2	LC2	2011	20	0.562849763	0.563178047	5.16	.	.
LOW	OPEN	3	LO3	2011	20	0.205297438	0.265581791	31.45685431	.	.
LOW	SHRUB	3	LS3	2011	20	0.175789019	0.177600511	31.98978906	.	.
LOW	CLOSED	3	LC3	2011	20	0.586748282	0.579706445	22.50324903	.	.
MID	OPEN	1	MO1	2011	20	1.018634333	1.016145501	8.431099622	.	.
MID	SHRUB	1	MS1	2011	20	0.941686333	0.92805786	11.2043978	.	.
MID	CLOSED	1	MC1	2011	20	1.014980628	0.989470325	11.29112911	.	.
MID	OPEN	2	MO2	2011	20	1.262660393	1.258838545	6.985110423	.	.
MID	SHRUB	2	MS2	2011	20	0.607431984	0.739246969	7.067173131	.	.
MID	CLOSED	2	MC2	2011	20	0.910264618	0.916464582	9.067279816	.	.
MID	OPEN	3	MO3	2011	20	1.127871363	1.137055946	5.788842232	.	.
MID	SHRUB	3	MS3	2011	20	0.544536713	0.553307807	12.50874913	.	.
MID	CLOSED	3	MC3	2011	20	1.171857205	1.200297809	7.932067932	.	.
HIGH	OPEN	1	HO1	2011	20	0.724094556	0.78159966	9.80980981	.	.
HIGH	SHRUB	1	HS1	2011	20	0.364157399	0.373984259	28.91602442	.	.
HIGH	CLOSED	1	HC1	2011	20	0.711401218	0.751754946	14.94494494	.	.
HIGH	OPEN	2	HO2	2011	20	0.706140918	0.726334822	13.05738852	.	.
HIGH	SHRUB	2	HS2	2011	20	0.611253028	0.692576048	15.3	.	.
HIGH	CLOSED	2	HC2	2011	20	0.891069888	0.891044459	13.46730654	.	.
HIGH	OPEN	3	HO3	2011	20	0.965890972	0.991916613	6.98930107	.	.
HIGH	SHRUB	3	HS3	2011	20	0.39469508	0.619123591	20.80583883	.	.
HIGH	CLOSED	3	HC3	2011	20	0.893703467	0.901723038	12.67873213	.	.
LOW	OPEN	1	LO1	2013	5	0.536490129	0.592468852	43.15107914	.	.
LOW	SHRUB	1	LS1	2013	5	0.202070985	0.203911742	54.23728814	.	.
LOW	CLOSED	1	LC1	2013	5	0.555824443	0.580385606	43.00699301	.	.
LOW	OPEN	2	LO2	2013	5	0.916246068	0.91760284	17.88567916	.	.
LOW	SHRUB	2	LS2	2013	5	0.195387656	0.237822788	28.42240117	.	.
LOW	CLOSED	2	LC2	2013	5	0.504430243	0.500786525	32.86785242	.	.
LOW	OPEN	3	LO3	2013	5	.	.	65.14884648	.	.
LOW	SHRUB	3	LS3	2013	5	.	.	77.69002962	.	.
LOW	CLOSED	3	LC3	2013	5	.	.	28.6268572	.	.
MID	OPEN	1	MO1	2013	5	0.493841064	0.494215911	20.4739763	.	.
MID	SHRUB	1	MS1	2013	5	0.440520473	0.432463284	54.94111623	.	.
MID	CLOSED	1	MC1	2013	5	0.629554386	0.632616413	36.57882279	.	.
MID	OPEN	2	MO2	2013	5	0.290208105	0.300382822	57.07118968	.	.
MID	SHRUB	2	MS2	2013	5	0.650680493	0.638769402	15.08631474	.	.
MID	CLOSED	2	MC2	2013	5	0.184407594	0.199457089	73.6393753	.	.
MID	OPEN	3	MO3	2013	5	0.683214527	0.729811373	21.86335404	.	.
MID	SHRUB	3	MS3	2013	5	0.140638494	0.145444421	17.50197837	.	.
MID	CLOSED	3	MC3	2013	5	0.311933368	0.374385745	20.82094834	.	.
HIGH	OPEN	1	HO1	2013	5	0.230093285	0.233312452	59.53456061	.	.
HIGH	SHRUB	1	HS1	2013	5	0.182110524	0.189851744	77.82592994	.	.
HIGH	CLOSED	1	HC1	2013	5	0.256267161	0.263771142	39.93610224	.	.
HIGH	OPEN	2	HO2	2013	5	0.214697428	0.220115543	82.59943182	.	.
HIGH	SHRUB	2	HS2	2013	5	0.107222592	0.118883553	92.09997127	.	.
HIGH	CLOSED	2	HC2	2013	5	0.241652724	0.256226074	80.94516813	.	.
HIGH	OPEN	3	HO3	2013	5	.	.	55.16051087	.	.
HIGH	SHRUB	3	HS3	2013	5	.	.	72.47814789	.	.
HIGH	CLOSED	3	HC3	2013	5	.	.	42.00898054	.	.

;
  

	/* Mixed model ANOVA*/
PROC MIXED data=cvi_bulk ;
	TITLE "soil bulk density for all soil profiles";
	CLASS ELEV VEG DEPTH YEAR;
  	MODEL BULKs = ELEV*VEG ELEV VEG DEPTH ELEV*DEPTH VEG*DEPTH;
		lsmeans ELEV / pdiff adjust = tukey cl;
		lsmeans VEG / pdiff adjust = tukey cl;
		lsmeans ELEV*VEG / pdiff adjust = tukey cl;
	ods output diffs=ppp lsmeans=mmm;

run;


PROC MIXED data=cvi_bulk ;
	TITLE "total bulk density for all profiles";
	CLASS ELEV VEG DEPTH YEAR;
  	MODEL BULKt = ELEV*VEG ELEV VEG DEPTH ELEV*DEPTH VEG*DEPTH;
		lsmeans ELEV / pdiff adjust = tukey cl;
		lsmeans VEG / pdiff adjust = tukey cl;
		lsmeans ELEV*VEG / pdiff adjust = tukey cl;
	ods output diffs=ppp lsmeans=mmm;

/* DATA SUBSETTING  */

	/*0 - 5 cm depth subest */
DATA FIVE;
	SET cvi_bulk;
	IF DEPTH = '5';
RUN;

PROC PRINT data=FIVE;

/* 0 - 12 cm depth subest */
DATA TWELVE;
	SET cvi_bulk;
	IF DEPTH = '12';
RUN;

PROC PRINT data=TWELVE;

/* 0 - 20 depth subset */
DATA TWENTY;
	SET cvi_bulk;
	IF DEPTH = '20';
RUN;

PROC PRINT data=TWENTY;

/* MIXED ANOVA using the dataset FIVE */
PROC MIXED data=FIVE ;
	TITLE "FIVE soil bulk elev*veg ANOVA";
	CLASS ELEV VEG DEPTH YEAR;
  	MODEL BULKs = ELEV*VEG ELEV VEG;
		lsmeans ELEV / pdiff adjust = tukey cl;
		lsmeans VEG / pdiff adjust = tukey cl;
		lsmeans ELEV*VEG / pdiff adjust = tukey cl;
	ods output diffs=ppp lsmeans=mmm;
run;



/* MIXED ANOVA using the dataset TWELVE */
PROC MIXED data=TWELVE ;
	TITLE "TWELVE soil elev*veg ANOVA";
	CLASS ELEV VEG DEPTH  YEAR;
  	MODEL BULKs = ELEV*VEG ELEV VEG;
		lsmeans ELEV / pdiff adjust = tukey cl;
		lsmeans VEG/ pdiff adjust = tukey cl;
		lsmeans ELEV*VEG/ pdiff adjust = tukey cl;
	ods output diffs=ppp lsmeans=mmm;
run;
	

/* MIXED ANOVA using the dataset TWENTY*/
PROC MIXED data=TWENTY ;
	TITLE "TWENTY soil elev*veg ANOVA";
	CLASS ELEV VEG DEPTH YEAR;
  	MODEL BULKs = ELEV*VEG ELEV VEG;
		lsmeans ELEV / pdiff adjust = tukey cl;
		lsmeans VEG / pdiff adjust = tukey cl;
		lsmeans ELEV*VEG / pdiff adjust = tukey cl;
	ods output diffs=ppp lsmeans=mmm;
run;

/* MIXED ANOVA using the dataset FIVE */
PROC MIXED data=FIVE ;
	TITLE "FIVE total bulk elev*veg ANOVA";
	CLASS ELEV VEG DEPTH  YEAR;
  	MODEL BULKt = ELEV*VEG ELEV VEG;
		lsmeans ELEV / pdiff adjust = tukey cl;
		lsmeans VEG / pdiff adjust = tukey cl;
		lsmeans ELEV*VEG / pdiff adjust = tukey cl;
	ods output diffs=ppp lsmeans=mmm;
run;


/* MIXED ANOVA using the dataset TWELVE */
PROC MIXED data=TWELVE ;
	TITLE "TWELVE total elev*veg ANOVA";
	CLASS ELEV VEG DEPTH  YEAR;
  	MODEL BULKt = ELEV*VEG ELEV VEG;
		lsmeans ELEV / pdiff adjust = tukey cl;
		lsmeans VEG/ pdiff adjust = tukey cl;
		lsmeans ELEV*VEG/ pdiff adjust = tukey cl;
	ods output diffs=ppp lsmeans=mmm;
run;


/* MIXED ANOVA using the dataset TWENTY*/
PROC MIXED data=TWENTY ;
	TITLE "TWENTY total elev*veg ANOVA";
	CLASS ELEV VEG DEPTH  YEAR;
  	MODEL BULKt = ELEV*VEG ELEV VEG;
		lsmeans ELEV / pdiff adjust = tukey cl;
		lsmeans VEG / pdiff adjust = tukey cl;
		lsmeans ELEV*VEG / pdiff adjust = tukey cl;
	ods output diffs=ppp lsmeans=mmm;
run;
